{% extends "auctions/layout.html" %}
{% block title %}
    {{ listing.title }}
{% endblock %}
{% block body %}

    {% if message %}
        <strong>{{ message }}</strong>
    {% endif %}

    <h2>Listing: {{ listing.title }}</h2>

    {% if owner %}
        <a class="nav-link" href="{% url 'updateListing' listing.id %}">Update Listing</a>
        <a class="nav-link" href="">Close the Auction</a>
    {% else %}
        {% if listing.active %}
            {% if on_watchList %}
                <form action="{% url 'remove_watchList' listing.id %}" method="post">
                    {% csrf_token %}
                    <input class="btn btn-primary" type="submit" value="Remove from Watchlist">
                </form>
            {% else %}
                <form action="{% url 'add_watchList' listing.id %}" method="post">
                    {% csrf_token %}
                    <input class="btn btn-primary" type="submit" value="Add to Watchlist">
                </form>
            {% endif %}
            <form action="{% url 'submitBid' listing.id %}" method="post">
                {% csrf_token %}
                {{ bidForm }}
                <input class="btn btn-primary" type="submit" value="Submit a Bid">
            </form>
        {% endif %}
    {% endif %}
  
    <h5>Details</h5>
    <!-- add image of listing -->
    <ul>
        <li>Current Bid: ${{ listing.currentBid }}</li> <!--hardcoded currency symbol, better option? -->
        <li>Listed by: {{ listing.owner }}</li> <!--link to userpage-->
        <li>Category: {{ listing.category }}</li> <!--link to category-->
    </ul>

    <h5>Bids</h5>
    {% for bid in bids %}
    <li>
            Bid Date/Time {{ bid.created_at }} Bid Amount {{ bid.amount }} by {{ bid.user }}
    </li>
    {% endfor %}

{% endblock %}